From a0391dcc6d1aabaff19fe4e6147f29054efcef9a Mon Sep 17 00:00:00 2001
From: Vladimir Ivakin <vladimir_iva@pisem.net>
Date: Tue, 31 Mar 2015 15:36:16 +0300
Subject: [PATCH] udev add partition event with empty mountpoint leads to
 segfault

---
 xbmc/storage/linux/UDevProvider.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/xbmc/storage/linux/UDevProvider.cpp b/xbmc/storage/linux/UDevProvider.cpp
index 84c931f..73cb62e 100644
--- a/xbmc/storage/linux/UDevProvider.cpp
+++ b/xbmc/storage/linux/UDevProvider.cpp
@@ -237,7 +237,7 @@ bool CUDevProvider::PumpDriveChangeEvents(IStorageEventsCallback *callback)
       {
         CLog::Log(LOGNOTICE, "UDev: Added %s", mountpoint);
         if (callback)
-          callback->OnStorageAdded(label, mountpoint);
+          callback->OnStorageAdded(label, (mountpoint ? mountpoint : ""));
         changed = true;
       }
       if (!strcmp(action, "remove") && !strcmp(devtype, "partition"))
-- 
2.2.1

